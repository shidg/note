select a.student_id,a.sname,b.tname from(select score.student_id,score.course_id,student.sname from score left join student on score.student_id = student.sid where course_id not in (select cid from course where teacher_id = (select tid from teacher where tname = '李平老师')))a left join (select course.cid,teacher.tname from course left join teacher on course.teacher_id = teacher.tid) b on a.course_id = b.cid;